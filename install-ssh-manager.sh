#!/bin/bash

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# ๐จ COLORES
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
GREEN="\033[1;32m"
RED="\033[1;31m"
YELLOW="\033[1;33m"
BLUE="\033[1;34m"
CYAN="\033[1;36m"
RESET="\033[0m"

SEPARADOR="${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${RESET}"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# ๐ RUTA DE INSTALACIรN
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
INSTALL_PATH="$HOME/bin"
SCRIPT_NAME="manager-ssh"
SCRIPT_URL="https://raw.githubusercontent.com/ChristopherAGT/sshws-gcp-config/main/ssh-manager.sh"

echo -e "$SEPARADOR"
echo -e "${YELLOW}๐ฆ Instalador del panel SSH-WS${RESET}"
echo -e "${BLUE}๐ URL del script:${RESET} $SCRIPT_URL"
echo -e "$SEPARADOR"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# ๐ Crear carpeta bin si no existe
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo -e "${CYAN}๐ Verificando directorio ${INSTALL_PATH}...${RESET}"
mkdir -p "$INSTALL_PATH"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# โฌ๏ธ Descargar el script
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo -e "${CYAN}โฌ๏ธ Descargando script...${RESET}"
curl -fsSL "$SCRIPT_URL" -o "$INSTALL_PATH/$SCRIPT_NAME"
if [[ $? -ne 0 || ! -s "$INSTALL_PATH/$SCRIPT_NAME" ]]; then
    echo -e "${RED}โ Error al descargar el script desde:${RESET} $SCRIPT_URL"
    echo -e "$SEPARADOR"
    exit 1
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# โ Dar permisos de ejecuciรณn
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
chmod +x "$INSTALL_PATH/$SCRIPT_NAME"
echo -e "${GREEN}โ Permisos de ejecuciรณn otorgados.${RESET}"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# ๐ง Agregar al PATH si es necesario
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
if [[ ":$PATH:" != *":$INSTALL_PATH:"* ]]; then
    echo -e "${YELLOW}โ Agregando $INSTALL_PATH al PATH en .bashrc...${RESET}"
    echo "export PATH=\"\$HOME/bin:\$PATH\"" >> "$HOME/.bashrc"
    source "$HOME/.bashrc"
fi

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# ๐ Mensaje final
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo -e "$SEPARADOR"
echo -e "${GREEN}โ Instalaciรณn completada correctamente.${RESET}"
echo -e "${BLUE}๐ Puedes iniciar el panel ejecutando:${RESET} ${YELLOW}manager-ssh${RESET}"
echo -e "$SEPARADOR"
